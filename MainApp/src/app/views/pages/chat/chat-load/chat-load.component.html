<div class="chat-header border-bottom pb-2">
  <div *ngIf="selUser!=null" class="d-flex justify-content-between">
    <div class="d-flex align-items-center ">
      <i class="feather icon-corner-up-left icon-md mr-2 ml-n2 text-muted d-lg-none"></i>
      <figure class="mb-0 mr-2">
        <img [src]="selUserImage" class="img-sm rounded-circle" alt="image">
        <div class="status online"></div>
        <div class="status online"></div>
      </figure>
      <div>
        <p>{{selUser.firstName}} {{selUser.lastName}}</p>
        <p class="text-muted tx-13">{{selUser.designation}}</p>
      </div>
    </div>
    <div class="d-flex align-items-center mr-n1">
      <a href="" (click)="false">
        <i class="feather icon-video icon-md text-muted mr-3" ngbTooltip="Start video call"></i>
      </a>
      <a href="" (click)="false">
        <i class="feather icon-phone-call icon-md text-muted mr-0 mr-sm-3" ngbTooltip="Start voice call"></i>
      </a>
      <a href="" (click)="false" class="d-none d-sm-block">
        <i class="feather icon-user-plus icon-md text-muted" ngbTooltip="Add to contacts"></i>
      </a>
    </div>
  </div>
</div>
<div class="chat-body" [perfectScrollbar] #scrollMe [scrollTop]="scrollMe.scrollHeight">
  <ul class="messages" *ngFor="let msg of displayMsgList , let i = index">
    <li *ngIf="msg.messageFrom == selUser.userName" class="message-item friend">
      <img [src]="selUserImage" class="img-xs rounded-circle" alt="avatar">
      <div class="content"(dblclick)="ToggleReplyMsg(msg)">
        <img *ngIf="msg.type == 'image'" [src]="localPath + msg.content" alt="Image" width="350px" height="200px">
        <video controls *ngIf="msg.type === 'video'">
          <source [src]="localPath + msg.content" type="video/mp4">
          Your browser does not support the video tag.
        </video>
        <audio controls *ngIf="msg.type === 'audio'">
          <source [src]="localPath + msg.content" type="audio/mp3">
          Your browser does not support the html audio tag.
        </audio>
        <div class="message" >
          <div class="bubble" *ngIf="msg.type === null">
            <div class="replymsg overflowrap" *ngIf="msg.repliedTo != null">{{msg.repliedTo}}</div>
            <div class="overflowrap">{{msg.content}}</div>
          </div>
            <span>{{msg.createdAt | date:'shortTime'}}</span>
        </div>
      </div>
    </li>
    <li *ngIf="msg.messageFrom == this.loggedInUser.UserName" class="message-item me">
      <img [src]="ImageSource" class="img-xs rounded-circle" alt="avatar">
      <div class="content" (dblclick)="ToggleReplyMsg(msg)">
        <img *ngIf="msg.type == 'image'" [src]="localPath + msg.content" alt="Image" width="350px" height="200px">
        <video controls *ngIf="msg.type === 'video'">
          <source [src]="localPath + msg.content" type="video/mp4">
          Your browser does not support the video tag.
        </video>
        <audio controls *ngIf="msg.type === 'audio'">
          <source [src]="localPath + msg.content" type="audio/mp3">
          Your browser does not support the html audio tag.
        </audio>
        <div class="message ">
          <div class="bubble" *ngIf="msg.type==null">
            <div class="replymsg overflowrap" *ngIf="msg.repliedTo != null">{{msg.repliedTo}}</div>
            <div class="overflowrap">{{msg.content}}</div>
          </div>
        </div>
          <div style="float:right;">
            <span>{{msg.createdAt | date:'shortTime'}}</span>
              <span *ngIf="msg.seen == 0" class="mdi mdi-check"></span>
              <span *ngIf="msg.seen == 1" class="mdi mdi-check-all"></span>
          </div>
      </div>
    </li>
  </ul>
</div>
<!-- Reply To A SPECIFIC MESSAGE -->
<div class="search-form flex-grow mr-2 margin-to-left-right" [hidden]="!IsReplying">
  <div class="input-group">
    <p type="text" class="form-control rounded-pill setColor" id="chatForm" readonly><span class="mdi mdi-reply"></span>{{RplyMsg}}</p>
    <span class="close-button onhoverr" aria-label="Close alert" data-close (click)="CloseRplyMsg()" >
      <span aria-hidden="true">&times;</span>
    </span>
  </div>
</div>
<div class="chat-footer d-flex">
  <div>
    <button type="button" class="btn border btn-icon rounded-circle mr-2" ngbTooltip="Emoji">
      <i class="feather icon-sun text-muted"></i>
    </button>
  </div>
  <div class="d-none d-md-block">
    <!-- To Trigger Modal -->
    <button type="button" class="btn border btn-icon rounded-circle mr-2" ngbTooltip="Attatch files" (click)="openBasicModal(basicModal)">
      <i class="feather icon-paperclip text-muted"></i>
    </button>
    <!-- MODAL -->
    <ng-template #basicModal let-modal>
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Select File To Send</h5>
        <button type="button" class="close" (click)="modal.close()" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <input type="file" class="file-upload" (change)="onFileSelected($event)" #File accept="audio/*,video/*,image/*">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="modal.close()">Close</button>
        <button type="button" class="btn btn-primary" (click)="UploadFile();modal.close()">Send</button>
      </div>
    </ng-template>
    <!-- CLOSE -->
  </div>
  <div class="d-none d-md-block">
    <button type="button" class="btn border btn-icon rounded-circle mr-2" ngbTooltip="Record you voice">
      <i class="feather icon-mic text-muted"></i>
    </button>
  </div>
  <div class="search-form flex-grow mr-2">
    <div class="input-group">
      <input type="text" class="form-control rounded-pill" id="chatForm" placeholder="Type a message" (keydown.enter)="onMessage(message)" #message >
    </div>
  </div>
  <div>
    <button type="button" class="btn btn-primary btn-icon rounded-circle" (click)="onMessage(message)">
      <i class="feather icon-send"></i>
    </button>
  </div>
</div>
